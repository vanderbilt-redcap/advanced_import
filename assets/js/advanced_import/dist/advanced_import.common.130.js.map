{"version":3,"file":"advanced_import.common.130.js","mappings":";;;;;;;;;;;;;AAAA,IAAIA,MAAM,GAAG,SAASA,MAAM,GAAE;EAAC,IAAIC,GAAG,GAAC,IAAI;IAACC,EAAE,GAACD,GAAG,CAACE,KAAK,CAACD,EAAE;EAAC,OAAOA,EAAE,CAAC,KAAK,EAAC,CAAED,GAAG,CAACG,UAAU,GAAEF,EAAE,CAAC,KAAK,EAAC,CAACA,EAAE,CAAC,YAAY,EAAC;IAACG,KAAK,EAAC;MAAC,KAAK,EAACJ,GAAG,CAACK,GAAG;MAAC,eAAe,EAAC,EAAE;MAAC,UAAU,EAAC,KAAK;MAAC,SAAS,EAAC,SAAS;MAAC,MAAM,EAAC;IAAI;EAAC,CAAC,EAAC,CAACJ,EAAE,CAAC,gBAAgB,EAAC;IAACG,KAAK,EAAC;MAAC,OAAO,EAACJ,GAAG,CAACM,QAAQ;MAAC,OAAO,EAAE,GAAE,CAACN,GAAG,CAACM,QAAQ,GAAC,GAAG,EAAEC,OAAO,CAAC,CAAC,CAAE;IAAE;EAAC,CAAC,CAAC,CAAC,EAAC,CAAC,CAAC,EAACN,EAAE,CAAC,KAAK,EAAC;IAACO,WAAW,EAAC;EAAkB,CAAC,EAAC,CAAER,GAAG,CAACS,cAAc,IAAIT,GAAG,CAACS,cAAc,GAAC,CAAC,GAAER,EAAE,CAAC,MAAM,EAAC,CAACD,GAAG,CAACU,EAAE,CAAC,WAAW,GAACV,GAAG,CAACW,EAAE,CAACX,GAAG,CAACY,WAAW,CAACZ,GAAG,CAACS,cAAc,CAAC,CAAC,GAAC,MAAM,GAACT,GAAG,CAACW,EAAE,CAACX,GAAG,CAACY,WAAW,CAACZ,GAAG,CAACa,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,GAACb,GAAG,CAACc,EAAE,EAAE,EAACb,EAAE,CAAC,iBAAiB,CAAC,CAAC,EAAC,CAAC,CAAC,CAAC,EAAC,CAAC,CAAC,GAACD,GAAG,CAACc,EAAE,EAAE,EAAE,MAAK,GAAEb,CAA8L,GAACD,GAAG,CAACc,EAAE,EAAE,CAAC,CAAC;AAC7wB,CAAC;AACD,IAAIG,eAAe,GAAG,EAAE;;;;;;;ACqBxB;AACA;AACA;AAEA;AACA;AACA;AAEA;EAEAC;IAAAL;IAAAM;IAAAC;IAAAd;IAAAe;IAAAZ;IAAAa;EAAA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;EACA;AACA;AAEA,yEAAe;EACfC;IACA;MACAC;MAAA;MACAC;MACAC;MACAC;MACAtB;MACAF;MACAyB;MACAC;MACAd;MAAA;MACAT;MACAG;MACAI;MACAD,WAAAA,EAAAA,2BAAAA;IACA;EACA;EACAkB;IACAC;MACAC;MACAC;IACA;EACA;EACAC;IACA;AACA;AACA;IACAC;MACA;MACA;MACA,iDACA;MACA,kDACA;IACA;IACAC;MACA;IACA;IACApB;MACA;MACA;MACA;MACA;MACA;IACA;EACA;EACAqB;IACA;EACA;EACAC;IACA;MACA;QACA;QACA;QACA;UAAAf;QAAA;QACA;QACA;QACA;QACA;UAAAY;UAAAI;QAAA;QACA;QACA;QAEA;UACA;QACA,OACA;UACA;UACA;UACA;UACA;QACA;MACA;QACA;UAAAC;QAAA;QACA;UAAAjB;QAAA;QACA;UAAAkB;QAAA;QACA;QACA;UAAAA;UAAAN;UAAAO;QAAA;QACA;MACA;IAEA;IACAC;MACA;QACA;QACA;QACA;QACA;MACA;QACA;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;QAAAC;MAAA;MACA;MACA;MACA;MACA;IACA;IACAC;MAAAlC;MAAAP;MAAAe;MAAAZ;IAAA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAuC;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACAC;QACA;QACA;QACA;QACA;QACA;QACA;MACA;IACA;EACA;AACA,CAAC;;AC3L8V,CAAC,oFAAe,oCAAG,EAAC;;;;ACAxR;AAC3B;AACL;;;AAG3D;AACA,CAAiI;AACjI,gBAAgB,sCAAU;AAC1B,EAAE,+CAAM;AACR,EAAE,MAAM;AACR,EAAE,eAAe;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA,iDAAe;;;;;;;;;;;;;;AClBf,IAAIpD,MAAM,GAAG,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;YACA;UACA;QACA;QACA;QACA;QACA;MACA;QACA;MACA;QACA;MACA;IAEA;IACAqF;MAAAD;IAAA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAxC;MACA;MACA;IACA;EACA;AACA,CAAC;;ACtG+V,CAAC,qFAAe,qCAAG,EAAC;;;;ACAxR;AAC3B;AACL;;;AAG5D;AACA,CAAiI;AACjI,gBAAgB,sCAAU;AAC1B,EAAE,gDAAM;AACR,EAAE,iDAAM;AACR,EAAE,0DAAe;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA,kDAAe;;;;;AC0Df;AACA;AACA;AACA;AAEA,mEAAe;EACf0C;IAAAC,YAAAA,EAAAA,2BAAAA;IAAAC,aAAAA,EAAAA,aAAAA;IAAAC,SAAAA,EAAAA,wBAAAA;EAAA;EACAxE;IACA;MACApB;MACAoF;IACA;EACA;EACArD;IACA;MACAH;MACAiE;MACAC;MACAC;IACA;IACAC;MAAA;IAAA;IACAC;MAAA;IAAA;IACArB;MACA;QAAA5D;MAAA;MACA;QAAA;MAAA;MACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;MACA;MACA;IACA;EACA;EACAmB;IACA+D;MACA;QACA;QACA;QACA;UACAC;UACAC;QACA;QACAD;QACAA;MACA;MACA;IACA;IACAE;MACA;QACA;QACA;QACA;UACAF;UACAC;QACA;QACAD;QACAA;MACA;MACA;IACA;IACA;AACA;AACA;IACA;MACA;MACA;MACAG;QACA;MACA;MACAA;QAAAhE;QAAAN;QAAAO;MAAA;QACAkC;UAAAnC;UAAAN;UAAAO;QAAA;MACA;MACA;IACA;IACAgE;MACA;QAAApD;MAAA;MACA;MACAA;IACA;IACA;MACA;IACA;IAEA;AACA;AACA;IACA;MAEA;QACA;UAAA;QAAA;QACAyB;QACA;QACA;UAAAxD;QAAA;QACA;QACA;UACAoF;UACAC;QACA;QACA;UAAAzF;QAAA;MACA;QACA;QACA;UACA;YAAAqB;cAAAjB;YAAA;UAAA;UACA;YAAAkB;UAAA;UACAoE;QACA;QACA;UACAF;UACAC;QACA;MACA;IACA;IACA;MACA;IACA;IACA;AACA;AACA;AACA;AACA;IACA;MACA;QACA;UAAAvF;QAAA;QACA;QACA;QACA;MACA;QACAuD;MACA;QACA;QACA;MACA;IACA;IACAS;MACA;MACAT;IACA;EACA;EACAkC;IACA;EACA;AACA,CAAC;;AChOiW,CAAC,0EAAe,8BAAG,EAAC;;ACArR;AACvC;AACL;;;AAGrD;AACA,CAAoI;AACpI,IAAI,gBAAS,GAAG,sCAAU;AAC1B,EAAE,qCAAM;AACR,EAAE,MAAM;AACR,EAAE,eAAe;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA,2CAAe,gBAAS","sources":["webpack://advanced_import/./src/components/FileUploader.vue","webpack://advanced_import/src/components/FileUploader.vue","webpack://advanced_import/./src/components/FileUploader.vue?f20f","webpack://advanced_import/./src/components/FileUploader.vue?8077","webpack://advanced_import/./src/components/LogsTable.vue","webpack://advanced_import/src/components/LogsTable.vue","webpack://advanced_import/./src/components/LogsTable.vue?2dcf","webpack://advanced_import/./src/components/LogsTable.vue?cc1c","webpack://advanced_import/./src/components/LogsTable.vue?1261","webpack://advanced_import/./src/components/LogsTable.vue?fdb0","webpack://advanced_import/./src/components/import/Review.vue","webpack://advanced_import/./src/components/import/Review.vue?6696","webpack://advanced_import/./src/components/FileProcesser.vue","webpack://advanced_import/src/components/FileProcesser.vue","webpack://advanced_import/./src/components/FileProcesser.vue?a823","webpack://advanced_import/./src/components/FileProcesser.vue?c2ef","webpack://advanced_import/src/components/import/Review.vue","webpack://advanced_import/./src/components/import/Review.vue?7ec4","webpack://advanced_import/./src/components/import/Review.vue?ce9c"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[(_vm.processing)?_c('div',[_c('b-progress',{attrs:{\"max\":_vm.max,\"show-progress\":\"\",\"animated\":false,\"variant\":\"primary\",\"size\":\"sm\"}},[_c('b-progress-bar',{attrs:{\"value\":_vm.progress,\"label\":`${(_vm.progress*100).toFixed(2)}%`}})],1),_c('div',{staticClass:\"text-muted small\"},[(_vm.uploaded_bytes && _vm.uploaded_bytes>0)?_c('span',[_vm._v(\"uploaded \"+_vm._s(_vm.formatBytes(_vm.uploaded_bytes))+\" of \"+_vm._s(_vm.formatBytes(_vm.file_size)))]):_vm._e(),_c('non-blank-space')],1)],1):_vm._e(),(false)?_c('section',{staticClass:\"debug\"},[_vm._v(\" \"+_vm._s(_vm.progress)+\" \"+_vm._s(_vm.uploaded_bytes)+\" \"+_vm._s(_vm.remote_file_name)+\" \"+_vm._s(_vm.file_size)+\" \"+_vm._s(_vm.processed)+\" \")]):_vm._e()])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div>\n        <div v-if=\"processing\">\n            <b-progress  :max=\"max\" show-progress :animated=\"false\" variant=\"primary\"  size=\"sm\">\n                <b-progress-bar :value=\"progress\" :label=\"`${(progress*100).toFixed(2)}%`\"></b-progress-bar>\n            </b-progress>\n            <!-- <button class=\"btn btn-danger\" @click=\"onPause\">Pause</button> -->\n            <div class=\"text-muted small\">\n                <span v-if=\"uploaded_bytes && uploaded_bytes>0\">uploaded {{formatBytes(uploaded_bytes)}} of {{formatBytes(file_size)}}</span>\n                <non-blank-space />\n            </div>\n        </div>\n        <section class=\"debug\" v-if=\"false\">\n            {{progress}}\n            {{uploaded_bytes}}\n            {{remote_file_name}}\n            {{file_size}}\n            {{processed}}\n        </section>\n    </div>\n</template>\n\n<script>\n// import { mapState } from 'vuex'\nimport FileReaderAsync from '@/libs/FileReaderAsync'\nimport {formatBytes} from '@/libs/Utility'\n\nconst MIN_CHUNK_SIZE = 1000 * 1024\nconst MAX_CHUNK_SIZE = 1000 * 1024 * 5\nconst TOTAL_CHUNKS = 20\n\nclass UploadMetadata {\n\n    constructor({file_size, name, percentage, progress, unique_name, uploaded_bytes, written_bytes}) {\n        this.file_size = file_size\n        this.name = name\n        this.percentage = percentage\n        this.progress = progress\n        this.unique_name = unique_name\n        this.uploaded_bytes = uploaded_bytes\n        this.written_bytes = written_bytes\n    }\n}\n\nexport default {\n    data() {\n        return {\n            cancel: null, // placeholder for canceling the promsie\n            content: '',\n            start: 0,\n            end: 0,\n            max:1,\n            processing: false,\n            paused: false,\n            abort: false,\n            remote_file_name: null, // unique file name used to save the file on the server\n            progress: 0,\n            uploaded_bytes:0,\n            file_size: 0,\n            formatBytes,\n        }\n    },\n    props: {\n        files: {\n            type: [File,Array],\n            default: () => []\n        }\n    },\n    computed: {\n        /* ...mapState({\n            file: state => state.import_settings.files,\n        }), */\n        file() {\n            let files = this.files\n            let file\n            if(typeof files==='object') file = files\n            else if(Array.isArray(files) && files.length>0) file = files[0]\n            if(file) return new File([file], file.name)\n            else return null\n        },\n        chunk_size() {\n            return this.calcChunkSize(this.file)\n        },\n        processed() {\n            let uploaded_bytes = this.uploaded_bytes || 0\n            let file_size = this.file_size || 0\n            let formatted_uploaded_bytes =  formatBytes(uploaded_bytes)\n            let formatted_file_size =  formatBytes(file_size)\n            return `${formatted_uploaded_bytes}/${formatted_file_size}`\n        }\n    },\n    destroyed() {\n        this.stop()\n    },\n    methods: {\n        async processChunk(file, chunk) {\n            try {\n                if(this.abort) return\n                const response = await this.sendChunk(file, chunk)\n                const {data} = response\n                if(!data) throw new Error('no response') //exit if no response data\n                const metadata = new UploadMetadata(data)\n                this.updateMetadata(metadata)\n                this.$emit('progress', {file, metadata}) // notify advancement\n                // advance the start\n                this.start = this.end\n\n                if(!this.paused && (this.end < file.size)) {\n                    return this.upload()\n                }\n                else {\n                    // exit if we are done\n                    this.reset()\n                    this.$emit('completed', metadata) // notify completed\n                    return metadata\n                }\n            } catch (error) {\n                const {response={}} = error\n                const {data={}} = response\n                const {message=''} = data\n                // console.log(message, file, error)\n                this.$emit('error', {message, file, error}) // notify error\n                this.reset()\n            }\n\n        },\n        calculateProgress(file, position) {\n            try {\n                const value = position / file.size\n                if(position<0) return 0\n                if(position>file.size) return 1\n                return value\n            } catch (error) {\n                return 0\n            }\n        },\n        sendChunk(file, chunk) {\n            const promise = this.$API.dispatch('upload/upload',file, chunk)\n            this.cancel = promise.cancel\n            return promise\n        },\n        calcChunkSize(file) {\n            if(!file) return MIN_CHUNK_SIZE\n            const {size=0} = file\n            let chunk_size = size/TOTAL_CHUNKS\n            if(chunk_size<MIN_CHUNK_SIZE) return MIN_CHUNK_SIZE\n            if(chunk_size>MAX_CHUNK_SIZE) return MAX_CHUNK_SIZE\n            return chunk_size\n        },\n        updateMetadata({file_size, progress, unique_name, uploaded_bytes}) {\n            this.file.unique_name = unique_name\n            this.remote_file_name = unique_name\n            this.uploaded_bytes = uploaded_bytes\n            this.file_size = file_size\n            this.progress = progress\n            return progress\n        },\n        async upload() {\n            if(!this.file) return\n            const file = this.file\n            this.processing = true\n            this.paused = false\n            this.end = this.start + this.chunk_size + 1\n            const blob = file.slice( this.start, this.end )\n            const file_reader = new FileReaderAsync()\n            const chunk = await file_reader.readAsDataURLAsync(blob)\n            return this.processChunk(file, chunk)\n        },\n        stop() {\n            if(typeof this.cancel==='function') this.cancel()\n            this.abort = true\n        },\n        onPause() {\n            this.processing = false\n            this.paused = true\n        },\n        reset() {\n            setTimeout(()=>{\n                this.cancel = null\n                this.start = 0\n                this.end = 0\n                this.processing = false\n                this.paused = false\n                this.abort = false\n            },1000)\n        }\n    }\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./FileUploader.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./FileUploader.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./FileUploader.vue?vue&type=template&id=786ceae4&\"\nimport script from \"./FileUploader.vue?vue&type=script&lang=js&\"\nexport * from \"./FileUploader.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"overflow-auto\"},[_c('div',{staticClass:\"d-flex flex-row justify-content-start align-items-start\"},[_c('b-button',{attrs:{\"size\":\"sm\",\"variant\":\"info\",\"disabled\":_vm.loading},on:{\"click\":_vm.getLogs}},[(_vm.loading)?_c('font-awesome-icon',{attrs:{\"icon\":\"spinner\",\"spin\":\"\"}}):_c('font-awesome-icon',{attrs:{\"icon\":\"sync\"}}),_c('span',[_vm._v(\" Reload\")])],1),(_vm.hasItems)?_c('b-button',{directives:[{name:\"b-modal\",rawName:\"v-b-modal.modal-delete\",modifiers:{\"modal-delete\":true}}],staticClass:\"ml-2\",attrs:{\"size\":\"sm\",\"variant\":\"danger\",\"disabled\":_vm.loading}},[_c('font-awesome-icon',{attrs:{\"icon\":\"trash\"}}),_c('span',[_vm._v(\" Delete logs\")])],1):_vm._e(),_c('b-modal',{attrs:{\"id\":\"modal-delete\",\"title\":\"Delete logs\"},on:{\"ok\":_vm.handleOkDelete}},[_c('p',{staticClass:\"my-4\"},[_vm._v(\"Are you sure you want to delete all logs for the current project?\")])]),(_vm.hasItems)?_c('b-pagination',{staticClass:\"ml-2\",attrs:{\"total-rows\":_vm.rows,\"per-page\":_vm.per_page,\"aria-controls\":\"my-table\",\"size\":\"sm\"},model:{value:(_vm.current_page),callback:function ($$v) {_vm.current_page=$$v},expression:\"current_page\"}}):_vm._e()],1),_c('b-table',{staticClass:\"my-2\",attrs:{\"id\":\"my-table\",\"items\":_vm.items_proxy,\"_per-page\":\"per_page\",\"_current-page\":\"current_page\",\"small\":\"\",\"bordered\":\"\",\"striped\":\"\",\"hover\":\"\"}}),(_vm.hasItems)?_c('b-pagination',{attrs:{\"total-rows\":_vm.rows,\"per-page\":_vm.per_page,\"aria-controls\":\"my-table\",\"size\":\"sm\"},model:{value:(_vm.current_page),callback:function ($$v) {_vm.current_page=$$v},expression:\"current_page\"}}):_vm._e()],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"overflow-auto\">\n    <div class=\"d-flex flex-row justify-content-start align-items-start\">\n        <b-button size=\"sm\" variant=\"info\" @click=\"getLogs\" :disabled=\"loading\">\n            <font-awesome-icon v-if=\"loading\" icon=\"spinner\" spin/>\n            <font-awesome-icon v-else icon=\"sync\" />\n            <span> Reload</span>\n        </b-button>\n        <b-button size=\"sm\" variant=\"danger\" class=\"ml-2\" v-b-modal.modal-delete :disabled=\"loading\" v-if=\"hasItems\">\n            <font-awesome-icon icon=\"trash\" />\n            <span> Delete logs</span>\n        </b-button>\n\n        <b-modal id=\"modal-delete\" title=\"Delete logs\" @ok=\"handleOkDelete\">\n            <p class=\"my-4\">Are you sure you want to delete all logs for the current project?</p>\n        </b-modal>\n\n        <b-pagination class=\"ml-2\" v-if=\"hasItems\"\n        v-model=\"current_page\"\n        :total-rows=\"rows\"\n        :per-page=\"per_page\"\n        aria-controls=\"my-table\"\n        size=\"sm\"\n        ></b-pagination>\n    </div>\n\n    <b-table\n      id=\"my-table\"\n      class=\"my-2\"\n      :items=\"items_proxy\"\n      _per-page=\"per_page\"\n      _current-page=\"current_page\"\n      small\n      bordered\n      striped\n      hover\n    ></b-table>\n    \n    <b-pagination v-if=\"hasItems\"\n        v-model=\"current_page\"\n        :total-rows=\"rows\"\n        :per-page=\"per_page\"\n        aria-controls=\"my-table\"\n        size=\"sm\"\n        ></b-pagination>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex'\n\n\nexport default {\n    data() {\n        return {\n            per_page: 20,\n            current_page: 1,\n            loading: false,\n        }\n    },\n    async created() {\n    },\n    computed: {\n        ...mapState({\n            items: state => state.logs.list,\n        }),\n        items_proxy() {\n            const items = [...this.items]\n            let per_page = this.per_page\n\n            let remainder = (this.current_page*per_page)-items.length\n            if(remainder<0) remainder = 0\n\n            const empty_value = \"\"\n            let placeholder = {'no logs': empty_value}\n            if(items.length>0) {\n                placeholder = {}\n                let first_item = items[0]\n                for(let key of Object.keys(first_item)) {\n                    placeholder[key] = empty_value\n                }\n            }\n\n            for(let i=0; i<remainder; i++) items.push(placeholder)\n            return items\n        },\n        rows() {\n            const total = this.$store.getters['logs/total']\n            return total || this.items.length\n        },\n        hasItems() {\n            try {\n                return this.items.length>0\n            } catch (error) {\n                return false\n            }\n        }\n    },\n    watch: {\n        current_page: {\n            immediate: true,\n            handler() {\n                this.getLogs()\n            }\n        }\n    },\n    methods: {\n        async getLogs() {\n            try {\n                this.loading = true\n                const limit = this.per_page\n                const start = this.per_page*(this.current_page-1)\n                const response =  await this.$API.dispatch('logs/get',{start, limit})\n                const {data={}} = response\n                const {data: list={}, metadata={}} = data\n                await this.$store.dispatch('logs/setState', {list, metadata})\n            } catch (error) {\n                console.log(error)\n            }finally {\n                this.loading = false\n            }\n        },\n        async handleOkDelete() {\n            const response =  await this.$API.dispatch('logs/delete')\n            console.log(response);\n            this.getLogs()\n        }\n    }\n}\n</script>\n\n<style scoped>\n#my-table >>> tbody td::before {\n    content: '';\n    display: block;\n    min-height: 20px;\n    float: left;\n}\n#my-table >>> tbody td {\n    vertical-align: middle;;\n}\n</style>","import mod from \"-!../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./LogsTable.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./LogsTable.vue?vue&type=script&lang=js&\"","// extracted by mini-css-extract-plugin\nexport {};","export * from \"-!../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-12.use[0]!../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??clonedRuleSet-12.use[1]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../node_modules/@vue/cli-service/node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-12.use[2]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./LogsTable.vue?vue&type=style&index=0&id=d102da56&prod&scoped=true&lang=css&\"","import { render, staticRenderFns } from \"./LogsTable.vue?vue&type=template&id=d102da56&scoped=true&\"\nimport script from \"./LogsTable.vue?vue&type=script&lang=js&\"\nexport * from \"./LogsTable.vue?vue&type=script&lang=js&\"\nimport style0 from \"./LogsTable.vue?vue&type=style&index=0&id=d102da56&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"d102da56\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('h6',[_vm._v(\"Review your settings\")]),_c('table',{staticClass:\"table table-bordered table-striped\"},[_vm._m(0),_c('tbody',_vm._l((_vm.settings),function(value,key){return _c('tr',{key:key},[_c('td',[_vm._v(_vm._s(key))]),_c('td',[_c('pre',[_vm._v(_vm._s(value))])])])}),0)]),_c('div',{staticClass:\"buttons d-flex flex-row justify-content-between\"},[_vm._t(\"left\"),_c('section',[_c('button',{staticClass:\"btn btn-primary ml-2\",attrs:{\"disabled\":_vm.processing},on:{\"click\":_vm.importCSV}},[(_vm.processing)?_c('font-awesome-icon',{attrs:{\"icon\":\"spinner\",\"spin\":\"\",\"fixed-width\":\"\"}}):_c('font-awesome-icon',{attrs:{\"icon\":\"file-import\",\"fixed-width\":\"\"}}),_c('span',[_vm._v(\" import\")])],1)]),_vm._t(\"right\",null,{\"validation\":_vm.$v})],2),_c('b-modal',{ref:\"modal-success\",attrs:{\"title\":\"Process completed\",\"ok-only\":\"\",\"size\":\"xl\"},on:{\"hidden\":_vm.onCloseModal}},[_c('p',{staticClass:\"my-4\"},[_vm._v(\"The import proces is completed. Please check the \"),_c('router-link',{attrs:{\"to\":{name:'logs'}}},[_vm._v(\"logs\")]),_vm._v(\" for details.\")],1),_c('LogsTable',{ref:\"logs\"})],1),_c('b-modal',{ref:\"modal-upload\",attrs:{\"title\":\"Uploading CSV file\",\"ok-only\":\"\",\"no-close-on-esc\":\"\",\"no-close-on-backdrop\":\"\",\"hide-header-close\":\"\",\"ok-title\":\"cancel\"},on:{\"ok\":_vm.onProcessStopped}},[_c('FileUploader',{ref:\"uploader\",attrs:{\"files\":_vm.files}})],1),_c('b-modal',{ref:\"modal-process\",attrs:{\"id\":\"modal-process\",\"title\":\"Processing CSV file\",\"ok-only\":\"\",\"no-close-on-esc\":\"\",\"no-close-on-backdrop\":\"\",\"hide-header-close\":\"\",\"ok-title\":\"cancel\",\"size\":\"xl\"},on:{\"ok\":_vm.onProcessStopped}},[_c('FileProcesser',{ref:\"processer\",attrs:{\"background_process\":_vm.background_process}}),_c('LogsTable',{ref:\"logs\"})],1),_c('b-modal',{ref:\"modal-abort\",attrs:{\"id\":\"modal-abort\",\"title\":\"Process stopped\",\"ok-only\":\"\"},on:{\"ok\":_vm.onProcessStopped}},[_c('p',{staticClass:\"my-4\"},[_vm._v(\"The process has been stopped by the user\")])])],1)\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('thead',[_c('tr',[_c('th',[_vm._v(\"key\")]),_c('th',[_vm._v(\"value\")])])])\n}]\n\nexport { render, staticRenderFns }","export * from \"-!../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Review.vue?vue&type=template&id=fcebd24e&scoped=true&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[(_vm.processing && !_vm.background_process)?_c('div',[_c('b-progress',{attrs:{\"max\":_vm.max,\"show-progress\":\"\",\"animated\":\"\",\"variant\":\"success\",\"height\":\"2rem\"}},[_c('b-progress-bar',{attrs:{\"value\":_vm.progress,\"label\":`${(_vm.progress*100).toFixed(2)}%`}})],1),_c('div',{staticClass:\"text-muted small my-2\"},[(_vm.total_lines && _vm.total_lines>0)?_c('span',[_vm._v(\"Processed \"+_vm._s(_vm.current_line)+\"/\"+_vm._s(_vm.total_lines))]):_vm._e(),_c('non-blank-space')],1)],1):_vm._e(),(false)?_c('section',{staticClass:\"debug\"},[_vm._v(\" \"+_vm._s(_vm.background_process)+\" \"+_vm._s(_vm.progress)+\" \"+_vm._s(_vm.processing)+\" \")]):_vm._e()])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div>\n        <div v-if=\"processing && !background_process\">\n            <b-progress  :max=\"max\" show-progress animated variant=\"success\" height=\"2rem\">\n                <b-progress-bar :value=\"progress\" :label=\"`${(progress*100).toFixed(2)}%`\"></b-progress-bar>\n            </b-progress>\n            <!-- <button class=\"btn btn-danger\" @click=\"onPause\">Pause</button> -->\n            <div class=\"text-muted small my-2\">\n                <span v-if=\"total_lines && total_lines>0\">Processed {{current_line}}/{{total_lines}}</span>\n                <non-blank-space />\n            </div>\n        </div>\n        <section class=\"debug\" v-if=\"false\">\n            {{background_process}}\n            {{progress}}\n            {{processing}}\n        </section>\n    </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex'\n\nexport default {\n    data() {\n        return {\n            cancel: null,\n            max:1,\n            current_line: 0,\n            processing: false,\n            abort: false,\n            progress: 0,\n        }\n    },\n    computed: {\n        ...mapState({\n            settings: state => state.import_settings,\n            total_lines: state => state.csv_data.total_lines,\n        }),\n    },\n    props: {\n        background_process: {\n            type: Boolean,\n            default: false\n        }\n    },\n    destroyed() {\n        this.reset()\n    },\n    methods: {\n        /**\n         * process a remote file.\n         * start from line 1 by default\n         * since on line 0 we usually have field names\n         */\n        async process(file_name, line=1) {\n            if(this.abort) return\n            this.processing = true\n            try {\n\n                const next = async (line) => {\n                    const settings = {...this.settings}\n                    settings.background_process = this.background_process //set the background process flag\n                    settings.data_row_start = line\n                    const promise = this.$API.dispatch('importData/processCSV',file_name, settings)\n                    this.cancel = promise.cancel\n                    const response = await promise\n                    const {data} = response\n                    if(data) {\n                        // exit if background process started\n                        if(this.background_process) return true;\n\n                        const {line=1} = data\n                        let progress = this.updateProgress({line})\n                        this.$emit('progress', {progress})\n                        return next(line)\n                    }\n                }\n                // await new Promise(resolve=>setTimeout(resolve, 10000))\n                await next(line)\n                this.$emit('completed')\n            } catch (error) {\n                this.$emit('error', error)\n            }finally {\n                this.processing = false\n            }\n\n        },\n        updateProgress({line}) {\n            if(this.total_lines<=0) return\n            if(line) this.current_line = line\n            if(isNaN(this.current_line) || isNaN(this.total_lines)) return\n            if(this.current_line>this.total_lines) this.current_line = this.total_lines\n            let progress = this.current_line/this.total_lines\n            this.progress = progress\n            return progress\n        },\n        reset() {\n            if(typeof this.cancel==='function') this.cancel()\n            this.abort = true\n        }\n    }\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./FileProcesser.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./FileProcesser.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./FileProcesser.vue?vue&type=template&id=084c3311&\"\nimport script from \"./FileProcesser.vue?vue&type=script&lang=js&\"\nexport * from \"./FileProcesser.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n    <div>\n        <h6>Review your settings</h6>\n        <table class=\"table table-bordered table-striped\">\n            <thead>\n                <tr>\n                    <th>key</th>\n                    <th>value</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr v-for=\"(value, key) in settings\" :key=\"key\">\n                    <td>{{key}}</td>\n                    <td><pre>{{value}}</pre></td>\n                </tr>\n            </tbody>\n        </table>\n        \n        <div class=\"buttons d-flex flex-row justify-content-between\" >\n            <slot name=\"left\" ></slot>\n            <!-- <slot>\n                <NOTE>CANNOT USE THIS BECAUSE IN CHROME RETURNS 'undefined'</NOTE>\n            </slot> -->\n            <section>\n                <button class=\"btn btn-primary ml-2\" @click=\"importCSV\" :disabled=\"processing\">\n                    <font-awesome-icon v-if=\"processing\" icon=\"spinner\" spin fixed-width/>\n                    <font-awesome-icon v-else icon=\"file-import\"  fixed-width/>\n                    <span> import</span>\n                </button>\n            </section>\n            <slot name=\"right\" :validation=\"$v\" ></slot>\n        </div>\n\n        <b-modal ref=\"modal-success\" title=\"Process completed\" ok-only @hidden=\"onCloseModal\" size=\"xl\">\n            <p class=\"my-4\">The import proces is completed. Please check the <router-link :to=\"{name:'logs'}\">logs</router-link> for details.</p>\n            <LogsTable ref=\"logs\"/>\n        </b-modal>\n\n        <b-modal ref=\"modal-upload\" title=\"Uploading CSV file\"\n            ok-only\n            no-close-on-esc\n            no-close-on-backdrop\n            hide-header-close\n            ok-title='cancel'\n            @ok=\"onProcessStopped\"\n        >\n            <FileUploader ref=\"uploader\" :files=\"files\"/>\n        </b-modal>\n\n        <b-modal ref=\"modal-process\" id=\"modal-process\" title=\"Processing CSV file\"\n            ok-only\n            no-close-on-esc\n            no-close-on-backdrop\n            hide-header-close\n            ok-title='cancel'\n            @ok=\"onProcessStopped\"\n            size=\"xl\"\n        >\n            <FileProcesser ref=\"processer\" :background_process=\"background_process\" />\n            <LogsTable ref=\"logs\"/>\n        </b-modal>\n\n        <b-modal ref=\"modal-abort\" id=\"modal-abort\" title=\"Process stopped\"\n            ok-only\n            @ok=\"onProcessStopped\"\n        >\n            <p class=\"my-4\">The process has been stopped by the user</p>\n        </b-modal>\n        \n        <!-- <b-button v-b-modal.modal-process>Launch demo modal</b-button> -->\n\n\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex'\nimport FileUploader from '@/components/FileUploader'\nimport FileProcesser from '@/components/FileProcesser'\nimport LogsTable from '@/components/LogsTable'\n\nexport default {\n    components: {FileUploader,FileProcesser, LogsTable},\n    data() {\n        return {\n            processing: false,\n            background_process: false,\n        }\n    },\n    computed: {\n        ...mapState({\n            files: state => state.import_settings.files,\n            event_id: state => state.import_settings.event_id,\n            form_name: state => state.import_settings.form_name,\n            import_settings: state => state.import_settings,\n        }),\n        dynamic_fields() { return this.$store.getters['import_settings/mappedDynamicFields'] },\n        mappedFieldsWithCsvNames() { return this.$store.getters['import_settings/mappedFieldsWithCsvNames'] },\n        settings() {\n            const {name:file_name=''} = this.files || {}\n            const import_settings = {...this.import_settings}\n            const settings = {\n                'file name': file_name,\n                'event ID': import_settings.event_id,\n                'form name': import_settings.form_name,\n                'field delimiter': import_settings.field_delimiter,\n                'text qualifier': import_settings.text_qualifier,\n                'dates format': import_settings.dates_format,\n                'import mode': import_settings.import_mode,\n                'primary key': import_settings.primary_key,\n                'dynamic fields': this.dynamic_fields,\n                'mapping': this.mappedFieldsWithCsvNames,\n            }\n            return settings\n        }\n    },\n    methods: {\n        showModal(ref_name) {\n            const promise = new Promise((resolve, reject) => {\n                const modal_element = this.$refs[ref_name]\n                if(!modal_element) return reject()\n                const onShown = () => {\n                    modal_element.$off('shown', onShown)\n                    resolve()\n                }\n                modal_element.$on('shown', onShown)\n                modal_element.show()\n            })\n            return promise\n        },\n        closeModal(ref_name) {\n            const promise = new Promise((resolve, reject) => {\n                const modal_element = this.$refs[ref_name]\n                if(!modal_element) return reject()\n                const onShown = () => {\n                    modal_element.$off('hidden', onShown)\n                    resolve()\n                }\n                modal_element.$on('hidden', onShown)\n                modal_element.hide()\n            })\n            return promise\n        },\n        /**\n         * upload a file for later processing\n         */\n        async upload() {\n            await this.showModal('modal-upload')\n            const uploader = this.$refs.uploader\n            uploader.$on('completed', () => {\n                this.closeModal('modal-upload')\n            })\n            uploader.$on('error', ({message, file, error})=> {\n                console.log({message, file, error})\n            })\n            return uploader.upload()\n        },\n        updateLogs() {\n            const {getLogs} = this.$refs.logs\n            if(typeof getLogs !=='function') return\n            getLogs()\n        },\n        async showCompleted() {\n            await this.showModal('modal-success')\n        },\n\n        /**\n         * process the reomte file\n         */\n        async enqueProcess(file_name) {\n\n            try {\n                const settings = {...this.import_settings}\n                settings.dynamic_fields = this.dynamic_fields // only gey dynamic fields that are actually mapped\n                const response = await this.$API.dispatch('importData/enqueue',file_name, settings)\n                const {data} = response\n                const message = `Import process created (ID ${data['job_id']}). Please check your logs.`\n                await this.$bvModal.msgBoxOk(message, {\n                    title: 'Success',\n                    buttonSize: 'sm',\n                })\n                this.$router.push({name: 'home'})\n            } catch (error) {\n                let error_message = error\n                if(typeof error === 'object') {\n                    const { response: {data} } = error\n                    const {message='error'} = data\n                    error_message = `${message}`\n                }\n                this.$bvModal.msgBoxOk(error_message, {\n                    title: 'Error',\n                    buttonSize: 'sm',\n                })\n            }            \n        },\n        async onProcessStopped() {\n            await this.showModal('modal-abort')\n        },\n        /**\n         * start the process:\n         * - upload the file\n         * - process the remote file\n         */\n        async importCSV() {\n            try {\n                const {unique_name} = await this.upload()\n                if(!unique_name) return\n                // let file_name = 'Data8277.csv'\n                await this.enqueProcess(unique_name)\n            } catch (error) {\n                console.log(error)\n            }finally {\n                this.processing = false\n                this.background_process = false\n            }\n        },\n        onCloseModal() {\n            // this.$router.push({name: 'home'})\n            console.log('done')\n        },\n    },\n    validations() {\n        return {}\n    }\n}\n</script>\n\n<style scoped>\n\n</style>","import mod from \"-!../../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Review.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Review.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Review.vue?vue&type=template&id=fcebd24e&scoped=true&\"\nimport script from \"./Review.vue?vue&type=script&lang=js&\"\nexport * from \"./Review.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"fcebd24e\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","_c","_self","processing","attrs","max","progress","toFixed","staticClass","uploaded_bytes","_v","_s","formatBytes","file_size","_e","remote_file_name","processed","staticRenderFns","constructor","name","percentage","unique_name","written_bytes","data","cancel","content","start","end","paused","abort","props","files","type","default","computed","file","chunk_size","destroyed","methods","metadata","response","message","error","calculateProgress","sendChunk","calcChunkSize","size","updateMetadata","stop","onPause","reset","setTimeout","loading","on","getLogs","hasItems","directives","rawName","modifiers","handleOkDelete","rows","per_page","model","value","current_page","callback","$$v","expression","items_proxy","items","placeholder","watch","immediate","handler","limit","list","console","_m","_l","settings","key","_t","importCSV","$v","ref","onCloseModal","onProcessStopped","background_process","total_lines","current_line","line","updateProgress","components","FileUploader","FileProcesser","LogsTable","event_id","form_name","import_settings","dynamic_fields","mappedFieldsWithCsvNames","showModal","modal_element","resolve","closeModal","uploader","updateLogs","title","buttonSize","error_message","validations"],"sourceRoot":""}