"use strict";(("undefined"!==typeof self?self:this)["webpackChunkadvanced_import"]=("undefined"!==typeof self?self:this)["webpackChunkadvanced_import"]||[]).push([[127],{8127:function(t,e,s){s.r(e),s.d(e,{default:function(){return x}});var a=function(){var t=this,e=t._self._c;return e("div",[e("p",[t._v("Monitor the status of the Jobs.")]),e("JobsTable"),e("div",{staticClass:"d-flex legend-wrapper"},[e("b-card",{attrs:{title:"Status",tag:"article"}},[e("ul",[e("li",[e("span",[e("font-awesome-icon",{staticClass:"text-primary",attrs:{"fixed-width":"",icon:["fas","bookmark"]}}),t._v(": "),e("span",[t._v("Job ready to be processed")])],1)]),e("li",[e("span",[e("font-awesome-icon",{staticClass:"text-success",attrs:{"fixed-width":"",icon:["fas","check-circle"]}}),t._v(": "),e("span",[t._v("Job process completed")])],1)]),e("li",[e("span",[e("font-awesome-icon",{staticClass:"text-secondary",attrs:{"fixed-width":"",icon:["fas","spinner"]}}),t._v(": "),e("span",[t._v("Job being processed")])],1)]),e("li",[e("span",[e("font-awesome-icon",{staticClass:"text-danger",attrs:{"fixed-width":"",icon:["fas","exclamation-circle"]}}),t._v(": "),e("span",[t._v("Job stopped due to error")])],1)]),e("li",[e("span",[e("font-awesome-icon",{staticClass:"text-secondary",attrs:{"fixed-width":"",icon:["fas","stop-circle"]}}),t._v(": "),e("span",[t._v("Job stopped by user")])],1)])])]),e("b-card",{staticClass:"ml-2",attrs:{title:"Actions",tag:"article"}},[e("ul",[e("li",[e("span",[e("font-awesome-icon",{staticClass:"text-primary",attrs:{"fixed-width":"",icon:["fas","stopwatch"]}}),t._v(": "),e("span",[t._v("Stop a Job in progress")])],1)]),e("li",[e("span",[e("font-awesome-icon",{staticClass:"text-success",attrs:{"fixed-width":"",icon:["fas","sync-alt"]}}),t._v(": "),e("span",[t._v("Start a stopped Job")])],1)]),e("li",[e("span",[e("font-awesome-icon",{staticClass:"text-danger",attrs:{"fixed-width":"",icon:["fas","trash"]}}),t._v(": "),e("span",[t._v("Delete a Job and its associated file")])],1)])])]),e("b-card",{staticClass:"ml-2",attrs:{title:"Types",tag:"article"}},[e("ul",[e("li",[e("span",[e("font-awesome-icon",{staticClass:"text-primary",attrs:{"fixed-width":"",icon:["fas","file-import"]}}),t._v(": "),e("span",[e("em",[t._v('"Import"')]),t._v(" type Job")])],1)]),e("li",[e("span",[e("font-awesome-icon",{staticClass:"text-danger",attrs:{"fixed-width":"",icon:["fas","file-export"]}}),t._v(": "),e("span",[e("em",[t._v('"Export"')]),t._v(" type Job")])],1)])])])],1)],1)},i=[],o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"overflow-auto"},[e("div",{staticClass:"d-flex flex-row justify-content-start align-items-start"},[e("b-button",{attrs:{size:"sm",variant:"info",disabled:t.loading},on:{click:t.getItems}},[t.loading?e("font-awesome-icon",{attrs:{icon:["fas","spinner"],spin:""}}):e("font-awesome-icon",{attrs:{icon:["fas","sync"]}}),e("span",[t._v(" Reload")])],1),e("b-modal",{attrs:{id:"modal-delete",title:"Delete jobs"},on:{ok:t.handleOkDelete}},[e("p",{staticClass:"my-4"},[t._v("Are you sure you want to delete all tasks for the current project?")])]),t.hasItems?e("b-pagination",{staticClass:"ml-2 mb-0",attrs:{"total-rows":t.rows,"per-page":t.per_page,"aria-controls":"my-table",size:"sm"},model:{value:t.current_page,callback:function(e){t.current_page=e},expression:"current_page"}}):t._e()],1),e("div",{staticClass:"table-wrapper"},[e("b-table",{staticClass:"my-2",attrs:{id:"my-table",items:t.items_proxy,fields:t.fields,"_per-page":"per_page","_current-page":"current_page",small:"",bordered:"",striped:"",hover:""},scopedSlots:t._u([{key:"cell(error)",fn:function(s){return[s.value?e("div",[e("div",{staticClass:"job-error text-muted small"},[t._v(t._s(s.value))])]):t._e()]}},{key:"cell(status)",fn:function(s){return[s.value?e("div",{staticClass:"d-flex justify-content-center align-items-center",attrs:{set:t.params=t.getStatusIcon(s.value)}},[e("font-awesome-icon",{class:t.params.class,attrs:{title:s.value,icon:t.params.icon,spin:t.params.spin}})],1):t._e()]}},{key:"cell(created_at)",fn:function(s){return[s.value?e("div",[t._v(t._s(s.value))]):t._e()]}},{key:"cell(updated_at)",fn:function(s){return[s.value?e("div",[t._v(t._s(s.value))]):t._e()]}},{key:"cell(completed_at)",fn:function(s){return[s.value?e("div",[t._v(t._s(s.value))]):t._e()]}},{key:"cell(type)",fn:function(s){return[s.value?e("div",{staticClass:"d-flex justify-content-center align-items-center"},["import"==s.value?e("font-awesome-icon",{staticClass:"text-primary",attrs:{title:s.value,icon:["fas","file-import"]}}):"export"==s.value?e("font-awesome-icon",{staticClass:"text-danger",attrs:{title:s.value,icon:["fas","file-export"]}}):t._e()],1):t._e()]}},{key:"cell(actions)",fn:function(s){return[s.item.id?e("div",{staticClass:"d-flex"},[e("b-button",{attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(e){return t.showSettings(s.item.settings)}}},[e("font-awesome-icon",{attrs:{icon:["fas","eye"],"fixed-width":""}})],1),"stopped"==s.item.status?e("b-button",{staticClass:"ml-2",attrs:{variant:"outline-success",size:"sm"},on:{click:function(e){return t.confirmStartTask(s.item.id)}}},[e("font-awesome-icon",{attrs:{icon:["fas","sync-alt"],"fixed-width":""}})],1):e("b-button",{staticClass:"ml-2",attrs:{variant:"outline-primary",size:"sm",disabled:t.getStopDisabled(s.item.status)},on:{click:function(e){return t.confirmStopTask(s.item.id)}}},[e("font-awesome-icon",{attrs:{icon:["fas","stopwatch"],"fixed-width":""}})],1),e("b-button",{staticClass:"ml-2",attrs:{variant:"outline-danger",size:"sm",disabled:t.getDeleteDisabled(s.item.status)},on:{click:function(e){return t.confirmDeleteTask(s.item.id)}}},[e("font-awesome-icon",{attrs:{icon:["fas","trash"],"fixed-width":""}})],1),t.debugMode?e("b-button",{staticClass:"ml-2",attrs:{variant:"outline-success",size:"sm"},on:{click:function(e){return t.showEdit(s.item)}}},[e("font-awesome-icon",{attrs:{icon:["fas","edit"],"fixed-width":""}})],1):t._e()],1):t._e()]}}])})],1),t.hasItems?e("b-pagination",{staticClass:"mb-2",attrs:{"total-rows":t.rows,"per-page":t.per_page,"aria-controls":"my-table",size:"sm"},model:{value:t.current_page,callback:function(e){t.current_page=e},expression:"current_page"}}):t._e(),e("b-modal",{ref:"modal-settings",attrs:{title:"Settings","ok-only":""}},[e("pre",[t._v(t._s(t.current_settings))])]),e("b-modal",{ref:"modal-edit",attrs:{title:"Edit","hide-footer":""}},[e("EditJob",{attrs:{job:t.editing_data},scopedSlots:t._u([{key:"footer",fn:function({form:s,object_keys:a}){return[e("div",{staticClass:"d-flex justify-content-end"},[e("b-button",{staticClass:"mr-2",attrs:{size:"sm",variant:"secondary"},on:{click:function(e){return t.$refs["modal-edit"].hide()}}},[t._v("Cancel")]),e("b-button",{attrs:{size:"sm",variant:"success"},on:{click:function(e){return t.editJob(s,a)}}},[t._v("OK")])],1)]}}])})],1)],1)},n=[],r=(s(7658),s(629)),c=function(){var t=this,e=t._self._c;return e("div",[t._l(t.form,(function(s,a){return e("b-form-group",{key:a,attrs:{label:a,"label-for":`input-${a}`}},[e("boolean"==typeof s?"b-form-checkbox":"b-form-input",{attrs:{id:`input-${a}`},model:{value:t.form[a],callback:function(e){t.$set(t.form,a,e)},expression:"form[key]"}})],1)})),e("footer",[t._t("footer",null,{form:t.form,object_keys:t.object_keys})],2)],2)},l=[],d={data(){return{form:{},object_keys:[]}},props:{job:{type:Object,default:null}},methods:{editObject(t,e){console.log(t,e)}},watch:{job:{immediate:!0,handler(t){for(let[e,s]of Object.entries(t))null==s?s=void 0:"object"==typeof s&&(this.object_keys.indexOf(e)<0&&this.object_keys.push(e),s=JSON.stringify(s)),this.$set(this.form,e,s)}}}},p=d,u=s(3736),f=(0,u.Z)(p,c,l,!1,null,null,null),m=f.exports;const b=Object.freeze({READY:"ready",ERROR:"error",COMPLETED:"completed",PROCESSING:"processing",STOPPED:"stopped",DELETED:"deleted"});var h={components:{EditJob:m},data(){return{items:[],metadata:{},fields:[{key:"id",lable:"ID"},{key:"status",lable:"Status"},{key:"processed_lines",lable:"Processed Lines"},{key:"error",lable:"Error"},{key:"created_at",lable:"Created at"},{key:"updated_at",lable:"Updated at"},{key:"completed_at",lable:"Completed at"},{key:"type",lable:"Type"},{key:"actions",lable:"Actions"}],per_page:10,current_page:1,loading:!1,current_settings:null,editing_data:null}},async created(){},computed:{...(0,r.rn)({debugMode:t=>t.app.debugMode}),fields_proxy(){const t=[...this.items];if(0==t.length)return[];let e=t.reduce(((t,e)=>{let s=Object.keys(e);return[...t,...s]}),[]);return[...e,...this.fields]},items_proxy(){const t=[...this.items];let e=this.per_page-t.length;e<0&&(e=0);for(let s=0;s<e;s++)t.push({});return t},rows(){const{total:t=0}=this.metadata;return t},hasItems(){try{return this.items.length>0}catch(t){return!1}}},watch:{current_page:{immediate:!0,handler(){this.getItems()}}},methods:{async getItems(){try{this.loading=!0,this.items=[],this.metadata={};const t=this.per_page,e=this.per_page*(this.current_page-1),s=await this.$API.dispatch("jobs/get",{start:e,limit:t}),{data:a={}}=s,{data:i={},metadata:o={}}=a;this.items=i,this.metadata=o}catch(t){console.log(t)}finally{this.loading=!1}},async handleOkDelete(){const t=await this.$API.dispatch("jobs/delete");console.log(t),this.getItems()},getStopDisabled(t){return t!=b.PROCESSING},getDeleteDisabled(t){const e=[b.PROCESSING,b.DELETED];return e.indexOf(t)>=0},getStatusIcon(t){let e={icon:["fas","tasks"],spin:!1};switch(t){case b.READY:e={...e,icon:["fas","bookmark"],class:"text-primary"};break;case b.COMPLETED:e={...e,icon:["fas","check-circle"],class:"text-success"};break;case b.PROCESSING:e={...e,icon:["fas","spinner"],class:"text-secondary",spin:!0};break;case b.ERROR:e={...e,icon:["fas","exclamation-circle"],class:"text-danger"};break;case b.STOPPED:e={...e,icon:["fas","stop-circle"],class:"text-secondary"};break;case b.DELETED:e={...e,icon:["fas","minus-circle"],class:"text-danger"};break;default:break}return e},async confirmStopTask(t){const e="Do you want to stop this job?",s=`Stop job ID ${t}`,a=await this.$bvModal.msgBoxConfirm(e,{title:s,size:"sm",buttonSize:"sm",okVariant:"primary",headerClass:"p-2 border-bottom-0",footerClass:"p-2 border-top-0",centered:!0});a&&this.stopTask(t)},async stopTask(t){let e,s,a;try{await this.$API.dispatch("jobs/stop",{id:t}),e=`The job id ${t} has been stopped.`,s="Success",a="success"}catch(i){e=`There was an error stopping the job ID ${t}.`,s="Error",a="danger"}finally{this.$bvToast.toast(e,{title:s,autoHideDelay:1500,appendToast:!0,variant:a}),this.getItems()}},async confirmStartTask(t){const e="Do you want to restart this job?",s=`Start job ID ${t}`,a=await this.$bvModal.msgBoxConfirm(e,{title:s,size:"sm",buttonSize:"sm",okVariant:"primary",headerClass:"p-2 border-bottom-0",footerClass:"p-2 border-top-0",centered:!0});a&&this.startTask(t)},async startTask(t){let e,s,a;try{await this.$API.dispatch("jobs/start",{id:t}),e=`The job id ${t} has been started.`,s="Success",a="success"}catch(i){e=`There was an error starting the job ID ${t}.`,s="Error",a="danger"}finally{this.$bvToast.toast(e,{title:s,autoHideDelay:1500,appendToast:!0,variant:a}),this.getItems()}},async confirmDeleteTask(t){const e="Do you want to delete this job?",s=`Delete job ID ${t}`,a=await this.$bvModal.msgBoxConfirm(e,{title:s,size:"sm",buttonSize:"sm",okVariant:"danger",headerClass:"p-2 border-bottom-0",footerClass:"p-2 border-top-0",centered:!0});a&&this.deleteTask(t)},async deleteTask(t){let e,s,a;try{await this.$API.dispatch("jobs/delete",{id:t}),e=`The job ID ${t} has been deleted.`,s="Success",a="success"}catch(i){e=`There was an error deleting the job ID ${t}.`,s="Error",a="danger"}finally{this.$bvToast.toast(e,{title:s,autoHideDelay:1500,appendToast:!0,variant:a}),this.getItems()}},showSettings(t){const e=this.$refs["modal-settings"];e&&(this.current_settings=t,e.show())},showEdit(t){const e=this.$refs["modal-edit"];e&&(this.editing_data=t,e.show())},async editJob(t,e){try{const s={...t},{id:a}=s;for(let t of e){const e=JSON.parse(s[t]);s[t]=e}await this.$API.dispatch("jobs/update",{id:a,data:{...s}})}catch(s){console.log(s),this.$bvModal.msgBoxOk("The JSON object is malformed and cannot be parsed. Data will not be updated.",{title:"Error parsing JSON",buttonSize:"sm",okVariant:"secondary",centered:!0})}finally{const t=this.$refs["modal-edit"];t&&t.hide(),this.getItems()}}}},y=h,_=(0,u.Z)(y,o,n,!1,null,"210fe272",null),g=_.exports,v={components:{JobsTable:g},computed:{}},k=v,w=(0,u.Z)(k,a,i,!1,null,"6e58a1a0",null),x=w.exports}}]);
//# sourceMappingURL=advanced_import.umd.min.127.js.map